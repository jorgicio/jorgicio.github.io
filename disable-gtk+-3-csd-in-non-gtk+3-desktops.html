<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)
 | Jorgicio's Crib</title>

    <meta name="author" content="Jorgicio"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="./theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="./theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="./theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">

    <!-- Feeds -->
      <link href="http://jorgicio.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jorgicio&#39;s Crib - All posts - Atom Feed"/>
      <link href="http://jorgicio.github.io/feeds/linux.atom.xml" type="application/atom+xml" rel="alternate" title="Jorgicio&#39;s Crib - Category: linux - Atom Feed"/>


  </head>

  <body>

    <div class="container">

      <div class="page-header">
          <a href="." class="avatar-container pull-left">
            <div class="avatar ">
              <div class="side"><img src="avatar.png" class="img-responsive"/></div>
            </div>
          </a>
        <h1><a href=".">Jorgicio's Crib</a> <small>The blog of the blogs</small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="." title="The blog of the blogs">Jorgicio's Crib</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                  <a href="./pages/about-me.html">About me</a>
                </li>
<li >
                  <a href="./pages/contact.html">Contact me!</a>
                </li>
<li >
                  <a href="./pages/suscribe.html">Suscribe!</a>
                </li>
<li >
                  <a href="./category/fables.html">fables</a>
                </li>
<li >
                  <a href="./category/informatics.html">informatics</a>
                </li>
<li >
                  <a href="./category/lgbt.html">lgbt</a>
                </li>
<li  class="active" >
                  <a href="./category/linux.html">linux <span class="sr-only">(current)</span></a>
                </li>
<li >
                  <a href="./category/news.html">news</a>
                </li>
<li >
                  <a href="./category/personal.html">personal</a>
                </li>
<li >
                  <a href="./category/social-networks.html">social networks</a>
                </li>
<li >
                  <a href="./category/society.html">society</a>
                </li>
<li >
                  <a href="./category/sports.html">sports</a>
                </li>
<li >
                  <a href="./category/videos.html">videos</a>
                </li>
          </ul>



        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="./disable-gtk+-3-csd-in-non-gtk+3-desktops.html" rel="bookmark" title="Permalink to Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)">Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <div>
    <p><img alt="GTK+" src="./images/gtk.png"></p>
<p>As a <a href="http://www.funtoo.org">Funtoo</a> user, and as a <a href="http://www.mate-desktop.org/">MATE</a> user, I had to deal with a problem with GTK+3-based apps when I have windows composition enabled, because popup windows are not drawn correctly. The reason? <a href="https://blogs.gnome.org/mclasen/2013/12/05/client-side-decorations-in-themes/">CSD</a>.</p>
<p><strong>C</strong>lient-<strong>S</strong>ide <strong>D</strong>ecorations is the new feature brought by GTK+3 since 3.12, that includes its own windows composition. The problem? It cannot be disabled by default, unless you can do some tricks. The <a href="https://gist.github.com/mlny/13c2597695ea2a91a5a8">CSS tweak</a> doesn't work as well as we wish.</p>
<p>While surfing through the Internet, I found <a href="https://aur.archlinux.org/packages/gtk3-noforcedcsd/">that package</a> in the AUR repository (from Arch Linux), from which I took 2 files that are useful for me.</p>
<p>Luckily, the GTK 3.0 ebuild for Gentoo (and based ones) contains the epatch_user instruction, so we can just put our own patches, and let Emerge do the rest of the part. </p>
<p><em><strong>Note:</strong> If you use any other Linux distro, you can do this too, but must patch manually, and re-compile the package from the source. Ask for the way to do for you distro.</em></p>
<p>First, download <a href="http://www.jorgicio.net/docs/gtk3nocsd/gtk_3.14_disable_csd_envvar_20141001.patch">this patch</a>, and put it inside:</p>
<p><code>/etc/portage/patches/x11-libs/gtk+:3/</code></p>
<p>Create those directories if not existing.</p>
<p>Then, recompile the GTK +3 package:</p>
<p><code>emerge -1 gtk+:3</code></p>
<p>Don't worry, the patch is applied itself. Just wait.</p>
<p>Meanwhile, add the right environment variable. You have 2 ways:</p>
<ol>
<li>As a system variable, download <a href="http://www.jorgicio.net/docs/gtk3nocsd/gtk3csd.sh">this file</a>, and put it inside <code>/etc/profile.d/</code>. Also, if needed, add execution permissions.</li>
<li>As an user variable. open the .profile or .xprofile file (create it if not available), and add the following line:
<code>export GTK_DISABLE_CSD=1</code></li>
</ol>
<p>For any of those, restart the session after GTK+ 3 compiled successfully.</p>
<p>Then, just try open any GTK+ 3 app (i.e. Transmission Torrent Client, Evolution, etc.). I tried with my Funtoo installation, using MATE and window composition enabled.</p>
<p>As it seems, CSD is a <a href="http://blog.martin-graesslin.com/blog/2010/05/why-you-should-not-use-client-side-window-decorations/">very bad idea</a>.</p>
<p><em>Jorgicio</em></p>
<p>P.S. This tutorial is also available in the <a href="http://forums.funtoo.org/topic/576-disable-gtk-3-csd-in-non-gtk3-desktops-eg-mate-or-xfce">Funtoo Forums</a>.</p>
  </div>


    <div class="comments">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'jorgicioscrib';
        var disqus_identifier = "disable-gtk+-3-csd-in-non-gtk+3-desktops.html";
        var disqus_title = "Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)";
        var disqus_url = "./disable-gtk+-3-csd-in-non-gtk+3-desktops.html";
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript>
    </div>

        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2015-06-07T20:19:00-03:00"><i class="fa fa-calendar"></i> Sun, 07 Jun 2015</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> By
          <a href="./author/jorgicio.html" rel="author">Jorgicio</a>
      </address></p>

    <hr/>

      <p>
              <a href="./category/linux.html" rel="tag"
                  data-toggle="tooltip" class="label label-info"
                  title="1 article in this category">linux</a>
            <a href="/tag/linux.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">linux</a>
            <a href="/tag/gentoo.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">gentoo</a>
            <a href="/tag/csd.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">csd</a>
            <a href="/tag/gtk.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">gtk</a>
            <a href="/tag/funtoo.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">funtoo</a>
            <a href="/tag/compilation.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">compilation</a>
            <a href="/tag/gnome.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">gnome</a>
            <a href="/tag/mate-desktop.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">mate desktop</a>
      </p>
      <hr/>



  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
                <h5>Social</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://twitter.com/jorgicio">
      <i class="fa fa-twitter"></i>
    Twitter
  </a></li>
                  <li>  <a href="http://facebook.com/jorgicio">
      <i class="fa fa-facebook-square"></i>
    Facebook
  </a></li>
                  <li>  <a href="http://github.com/jorgicio">
      <i class="fa fa-github"></i>
    Github
  </a></li>
                  <li>  <a href="http://last.fm/user/jorgicio">
      <img src="https://icons.better-idea.org/icon?url=last.fm&size=16" width="16" height="16" class="icon" alt="last.fm icon"/>
    Last FM
  </a></li>
                </ul>
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://www.jorgicio.net">
      <img src="https://icons.better-idea.org/icon?url=www.jorgicio.net&size=16" width="16" height="16" class="icon" alt="www.jorgicio.net icon"/>
    Personal Website
  </a></li>
                  <li>  <a href="http://blog.jorgicio.net">
      <img src="https://icons.better-idea.org/icon?url=blog.jorgicio.net&size=16" width="16" height="16" class="icon" alt="blog.jorgicio.net icon"/>
    My other blog (in Spanish!)
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright notice</h5>
            <p>© Copyright 2015 Jorgicio.</p>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>Anyway, everything I write here, is my responsability. Not what all of you understand. This is NOT the translation of my other blog, which is entirely in Spanish.</p>
          </div>

          <div class="col-md-2">
              <h5>Feeds</h5>
              <ul class="list-unstyled">
                  <li><small><a href="http://jorgicio.github.io/feeds/all.atom.xml"><i class="fa fa-rss"></i> All posts (Atom)</a></small></li>
                  <li><small><a href="http://jorgicio.github.io/feeds/linux.atom.xml"><i class="fa fa-rss"></i> Category: linux (Atom)</a></small></li>
              </ul>
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="./theme/js/jquery.mglass.js"></script>
    <script src="./theme/js/application.js"></script>

  </body>
</html>