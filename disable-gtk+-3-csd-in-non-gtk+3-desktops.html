<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>

    <title>  Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)
 | Jorgicio's Crib</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content=""/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap-responsive.min.css"/>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="//cdn.jsdelivr.net/jquery.magnific-popup/0.9.9/magnific-popup.css"/>
    <link rel="stylesheet" href="http://jorgicio.github.io/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="http://jorgicio.github.io/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="http://jorgicio.github.io/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='//fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='//fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="http://jorgicio.github.io/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="http://jorgicio.github.io/favicon.ico" type="image/x-icon">

    <!-- Feeds -->
      <link href="http://jorgicio.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jorgicio&#39;s Crib Full Atom Feed"/>
      <link href="http://jorgicio.github.io/feeds/linux.atom.xml" type="application/atom+xml" rel="alternate" title="Jorgicio&#39;s Crib Categories Atom Feed"/>


  </head>

  <body>
    <div class="container">

      <header>
        <div class="page-header">
            <a href="http://jorgicio.github.io" class="avatar-container">
              <div class="avatar ">
                <div class="side"><img src="avatar.png"/></div>
              </div>
            </a>
          <h1><a href="http://jorgicio.github.io">Jorgicio's Crib</a> <small>The blog of the blogs</small></h1>
        </div>

        <div class="navbar">
          <div class="navbar-inner">
            <a class="brand" href="http://jorgicio.github.io" title="The blog of the blogs">Jorgicio's Crib</a>
            <ul class="nav">
                  <li ><a href="http://jorgicio.github.io/pages/about-me.html">About me</a></li>
                  <li ><a href="http://jorgicio.github.io/pages/contact.html">Contact me!</a></li>
                  <li ><a href="http://jorgicio.github.io/pages/suscribe.html">Suscribe!</a></li>
            </ul>
          </div>
        </div>
      </header>

      <section>

        <div class="row">
          <div class=" span9  ">
  <h1>
    <a href="http://jorgicio.github.io/disable-gtk+-3-csd-in-non-gtk+3-desktops.html" rel="bookmark" title="Permalink to Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)">Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)</a>
  </h1>
          </div>
        </div>

        <div class="row">


          <div class=" span9 " id="content" role="main">
  

  <div>
    <p><img alt="GTK+" src="http://jorgicio.github.io/images/gtk.png" /></p>
<p>As a <a href="http://www.funtoo.org">Funtoo</a> user, and as a <a href="http://www.mate-desktop.org/">MATE</a> user, I had to deal with a problem with GTK+3-based apps when I have windows composition enabled, because popup windows are not drawn correctly. The reason? <a href="https://blogs.gnome.org/mclasen/2013/12/05/client-side-decorations-in-themes/">CSD</a>.</p>
<p><strong>C</strong>lient-<strong>S</strong>ide <strong>D</strong>ecorations is the new feature brought by GTK+3 since 3.12, that includes its own windows composition. The problem? It cannot be disabled by default, unless you can do some tricks. The <a href="https://gist.github.com/mlny/13c2597695ea2a91a5a8">CSS tweak</a> doesn't work as well as we wish.</p>
<p>While surfing through the Internet, I found <a href="https://aur.archlinux.org/packages/gtk3-noforcedcsd/">that package</a> in the AUR repository (from Arch Linux), from which I took 2 files that are useful for me.</p>
<p>Luckily, the GTK 3.0 ebuild for Gentoo (and based ones) contains the epatch_user instruction, so we can just put our own patches, and let Emerge do the rest of the part. </p>
<p><em><strong>Note:</strong> If you use any other Linux distro, you can do this too, but must patch manually, and re-compile the package from the source. Ask for the way to do for you distro.</em></p>
<p>First, download <a href="http://www.jorgicio.net/docs/gtk3nocsd/gtk_3.14_disable_csd_envvar_20141001.patch">this patch</a>, and put it inside:</p>
<p><code>/etc/portage/x11-libs/gtk+:3/</code></p>
<p>Create those directories if not existing.</p>
<p>Then, recompile the GTK +3 package:</p>
<p><code>emerge -1 gtk+:3</code></p>
<p>Don't worry, the patch is applied itself. Just wait.</p>
<p>Meanwhile, add the right environment variable. You have 2 ways:</p>
<ol>
<li>As a system variable, download <a href="http://www.jorgicio.net/docs/gtk3nocsd/gtk3csd.sh">this file</a>, and put it inside <code>/etc/profile.d/</code>. Also, if needed, add execution permissions.</li>
<li>As an user variable. open the .profile or .xprofile file (create it if not available), and add the following line:
<code>export GTK_DISABLE_CSD=1</code></li>
</ol>
<p>For any of those, restart the session after GTK+ 3 compiled successfully.</p>
<p>Then, just try open any GTK+ 3 app (i.e. Transmission Torrent Client, Evolution, etc.). I tried with my Funtoo installation, using MATE and window composition enabled.</p>
<p>As it seems, CSD is a <a href="http://blog.martin-graesslin.com/blog/2010/05/why-you-should-not-use-client-side-window-decorations/">very bad idea</a>.</p>
<p><em>Jorgicio</em></p>
<p>P.S. This tutorial is also available in the <a href="http://forums.funtoo.org/topic/576-disable-gtk-3-csd-in-non-gtk3-desktops-eg-mate-or-xfce">Funtoo Forums</a>.</p>
  </div>


    <div class="comments">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'jorgicioscrib';
        var disqus_identifier = "disable-gtk+-3-csd-in-non-gtk+3-desktops.html";
        var disqus_title = "Disable GTK+ 3 CSD in non-GTK+3 desktops (e.g. MATE or XFCE)";
        var disqus_url = "http://jorgicio.github.io/disable-gtk+-3-csd-in-non-gtk+3-desktops.html";
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript>
    </div>

          </div>

            <div class="span3">
  <div class="well">

    <p><abbr class="fa fa-calendar" title="2015-06-07T20:19:00-03:00"> Sun, 07 Jun 2015</abbr></p>

      <p><address class="fa fa-user"> By <a href="http://jorgicio.github.io/author/jorgicio.html" rel="author">Jorgicio</a></address></p>


    <hr/>

      <p>
              <a href="http://jorgicio.github.io/category/linux.html" rel="tag tooltip" class="label label-info" data-placement="right" data-original-title="1 article in this category">linux</a>
            <a href="/tag/linux.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">linux</a>
            <a href="/tag/csd.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">csd</a>
            <a href="/tag/gtk.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">gtk</a>
            <a href="/tag/gentoo.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">gentoo</a>
            <a href="/tag/funtoo.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">funtoo</a>
            <a href="/tag/compilation.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">compilation</a>
            <a href="/tag/gnome.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">gnome</a>
            <a href="/tag/mate-desktop.html" rel="tooltip" class="label" data-placement="right" data-original-title="1 article with this tag">mate desktop</a>
      </p>
      <hr/>
<section>
    <p id="post-share-links">
        Share on:
        <a href="https://sharetodiaspora.github.io/?title=Disable%20GTK%2B%203%20CSD%20in%20non-GTK%2B3%20desktops%20%28e.g.%20MATE%20or%20XFCE%29&url=http%3A//jorgicio.github.io/disable-gtk%2B-3-csd-in-non-gtk%2B3-desktops.html" target="_blank" title="Share on Diaspora">Diaspora*</a>
        ❄
        <a href="http://twitter.com/home?status=Disable%20GTK%2B%203%20CSD%20in%20non-GTK%2B3%20desktops%20%28e.g.%20MATE%20or%20XFCE%29%20http%3A//jorgicio.github.io/disable-gtk%2B-3-csd-in-non-gtk%2B3-desktops.html" target="_blank" title="Share on Twitter">Twitter</a>
        ❄
        <a href="http://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=http%3A//jorgicio.github.io/disable-gtk%2B-3-csd-in-non-gtk%2B3-desktops.html" target="_blank" title="Share on Facebook">Facebook</a>
        ❄
        <a href="https://plus.google.com/share?url=http%3A//jorgicio.github.io/disable-gtk%2B-3-csd-in-non-gtk%2B3-desktops.html" target="_blank" title="Share on Google Plus">Google+</a>
        ❄
        <a href="mailto:?subject=Disable%20GTK%2B%203%20CSD%20in%20non-GTK%2B3%20desktops%20%28e.g.%20MATE%20or%20XFCE%29&amp;body=http%3A//jorgicio.github.io/disable-gtk%2B-3-csd-in-non-gtk%2B3-desktops.html" target="_blank" title="Share via Email">Email</a>
    </p>
</section>


  </div>
              
            </div>

        </div>
      </section>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="span2">
                <h5>Social</h5>
                <ul class="unstyled">
                  <li>  <a href="http://twitter.com/jorgicio">
      <i class="fa fa-twitter"></i>
    Twitter
  </a></li>
                  <li>  <a href="http://facebook.com/jorgicio">
      <i class="fa fa-facebook-square"></i>
    Facebook
  </a></li>
                  <li>  <a href="http://github.com/jorgicio">
      <i class="fa fa-github"></i>
    Github
  </a></li>
                  <li>  <a href="http://last.fm/user/jorgicio">
      <img src="http://g.etfv.co/http://last.fm?defaulticon=lightpng" width="16" height="16" class="icon" alt="last.fm icon"/>
    Last FM
  </a></li>
                </ul>
            </div>
            <div class="span2">
                <h5>Links</h5>
                <ul class="unstyled">
                  <li>  <a href="http://www.jorgicio.net">
      <img src="http://g.etfv.co/http://www.jorgicio.net?defaulticon=lightpng" width="16" height="16" class="icon" alt="www.jorgicio.net icon"/>
    Personal Website
  </a></li>
                  <li>  <a href="http://blog.jorgicio.net">
      <img src="http://g.etfv.co/http://blog.jorgicio.net?defaulticon=lightpng" width="16" height="16" class="icon" alt="blog.jorgicio.net icon"/>
    My other blog (in Spanish!)
  </a></li>
                </ul>
            </div>

          <div class="span2">
            <h5>Browse content by</h5>
            <ul class="fa-ul">

                <li><a href="http://jorgicio.github.io/feeds/linux.atom.xml"><i class="fa-li fa fa-rss"></i> Feed</a></li>
            </ul>
          </div>

          <div class="span2 muted">
            <h5>Copyright notice</h5>
            <p>© Copyright 2015 Jorgicio.</p>
          </div>

          <div class="span2 muted">
            <h5>Disclaimer</h5>
              <p>Anyway, everything I write here, is my responsability. Not what all of you understand. This is NOT the translation of my other blog, which is entirely in Spanish.</p>
          </div>

          <div class="span2">
            <h5 class="pull-right"><a href="#" class="fa fa-arrow-up"> Back to top</a></h5>
          </div>

        </div>
      </div>

      <div class="container">
        <div class="row span12 muted text-center">
          Site generated by <a href="http://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="http://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>


    <script src="//code.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <script src="//cdn.jsdelivr.net/jquery.magnific-popup/0.9.9/jquery.magnific-popup.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script src="http://jorgicio.github.io/theme/js/jquery.mglass.js"></script>
    <script src="http://jorgicio.github.io/theme/js/application.js"></script>

  </body>
</html>